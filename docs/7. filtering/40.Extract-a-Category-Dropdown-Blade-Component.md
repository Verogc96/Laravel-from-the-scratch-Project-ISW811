[< Volver al índice](../index.md)

# Extract a Category Dropdown Blade Component

En este episodio se realizó un reacomodo del codigo del dropdown de las categorias por lo que se realizan los siguientes pasos:

- Ejecutar el comando `php artisan make:component CategoryDropdown` en la ruta del proyecto. Esto nos genera dos archivos uno en la ruta **app/Http/View/Components** llamado _CategoryDropdown.php_ y otro en la ruta **resources/views/components** llamado _category-dropdown_.

- Creamos un folder en **resources/views/** llamado _posts_ y ahi movemos los archivos _posts-header.blade.php, posts.blade.php y post.blade.php y les cambiamos los nombre como se indica a continuacion:

    - _posts-header.blade.php = _header.blade.php
    - post.blade.php = show.blade.php
    - posts.blade.php = index.blade.php

- Y modificamos los archivos segun se indica a continuacion:

### _header.blade.php

Se elimina el contenido del div de Category y se pega en el archivo nuevo category-dropdown

```php
<!--  Category -->
<div class="relative lg:inline-flex bg-gray-100 rounded-xl">
    <x-category-dropdown />
</div>
```

### category-dropdown.blade.php

Se agrega el codigo que estaba anteriormente en _header.blade.php

```php
<x-dropdown>
    <x-slot name="trigger">
        <button class="py-2 pl-3 pr-9 text-sm font-semibold w-full lg:w-32 text-left flex lg:inline-flex">
            {{ isset($currentCategory) ? ucwords($currentCategory->name) : 'Categories' }}

            <x-icon name="down-arrow" class="absolute pointer-events-none" style="right: 12px;"/>
        </button>
    </x-slot>

    <x-dropdown-item href="/" :active="request()->routeIs('home')">All</x-dropdown-item>

    @foreach ($categories as $category)
        <x-dropdown-item
            href="/?category={{ $category->slug }}"
            :active='request()->is("categories/{$category->slug}")'
        >{{ ucwords($category->name) }}</x-dropdown-item>
    @endforeach
</x-dropdown>
```


### index.blade.php

Se modifica el @include.

```php
 @include ('posts._header')
```

### CategoryDropdown.php

Se agrega la busqueda de todas las categorias y la actual

```php
 public function render()
    {
        return view('components.category-dropdown', [
            'categories' => Category::all(),
            'currentCategory' => Category::firstWhere('slug', request('category'))
        ]);
    }
```

### web.php

Se elimina 'categories' de la ruta de la busqueda por autores

```php
Route::get('/authors/{author}', function (User $author) {
    return view ('posts', [
        'posts'=> $author->posts
    ]);
});
```

### PostController.php

Se agregan los nombres de las funciones como buenas practicas.

```php
public function index()
    {
        return view('posts.index', [
            'posts' => Post::latest()->filter(request(['search', 'category']))->get()

        ]);
    }

    public function show(Post $post)
    {
        return view('post.show', [
            'post' => $post
        ]);
    }
```
